{% extends "base.html" %}
{% block content %}
  <h1 class="text-xl font-semibold">Forward Zones (Split DNS)</h1>
  <p class="mt-1 text-sm text-slate-400">Routing specific domains or networks to different DNS servers.</p>

  <div class="mt-6 space-y-6">
    <div class="rounded-2xl border border-slate-800 bg-bg-800 p-6">
      <h2 class="text-lg font-semibold text-slate-200">What is split DNS?</h2>
      <p class="mt-2 text-sm text-slate-300">
        Forward zones let you route DNS queries for specific domains to custom DNS servers, while all other queries use your default configuration (public DNS, Google, Cloudflare, etc.).
      </p>
      <p class="mt-2 text-sm text-slate-300">
        This is useful for:
      </p>
      <ul class="mt-2 list-disc pl-5 text-sm text-slate-300 space-y-1">
        <li>Internal domains that need to resolve different results locally vs. externally</li>
        <li>Corporate VPN/office networks with internal DNS servers</li>
        <li>Local development environments (e.g., routing <code class="bg-bg-900 px-1 rounded">*.local</code> to a local container)</li>
        <li>Legacy systems with custom DNS infrastructure</li>
      </ul>
    </div>

    <div class="rounded-2xl border border-slate-800 bg-bg-800 p-6">
      <h2 class="text-lg font-semibold text-slate-200">How it works in PowerBlockade</h2>
      <ol class="mt-2 list-decimal pl-5 text-sm text-slate-300 space-y-2">
        <li>Create a forward zone entry with a domain (or suffix) and target DNS server(s)</li>
        <li>Set <strong>Node Scope</strong> to either <em>Global</em> or a specific secondary node</li>
        <li>Click <strong>Apply</strong> to generate the config file</li>
        <li>PowerDNS Recursor detects the change and reloads (~5 seconds)</li>
      </ol>
      <p class="mt-3 text-sm text-slate-400">
        üí° Like RPZ zones, the recursor-reloader runs <code class="bg-bg-900 px-1 rounded">rec_control reload-zones</code> when config changes.
      </p>
    </div>

    <div class="rounded-2xl border border-slate-800 bg-bg-800 p-6">
      <h2 class="text-lg font-semibold text-slate-200">Node scopes: Global vs. Per-node</h2>
      <p class="mt-2 text-sm text-slate-300">
        Forward zones can be configured at two levels:
      </p>
      <table class="mt-2 w-full text-sm">
        <thead>
          <tr class="border-b border-slate-700">
            <th class="py-2 text-left text-slate-200">Scope</th>
            <th class="py-2 text-left text-slate-200">When to use</th>
          </tr>
        </thead>
        <tbody class="text-slate-300">
          <tr>
            <td class="py-2"><strong>Global</strong></td>
            <td class="py-2">Apply to all nodes (primary + secondaries). Use for network-wide overrides.</td>
          </tr>
          <tr>
            <td class="py-2"><strong>Per-node</strong></td>
            <td class="py-2">Apply only to a specific secondary node. Use for site-specific routing (e.g., office vs. home).</td>
          </tr>
        </tbody>
      </table>
      <div class="mt-4 rounded-lg border border-indigo-500/30 bg-indigo-500/10 p-3">
        <p class="text-sm text-indigo-200">
          üí° <strong>Node-specific overrides</strong> let you serve different internal DNS results on different network segments. Example: <code class="bg-bg-900 px-1 rounded">internal.company.com</code> office ‚Üí <code class="bg-bg-900 px-1 rounded">10.0.1.10</code>, home ‚Üí <code class="bg-bg-900 px-1 rounded">cloud-proxy</code>.
        </p>
      </div>
    </div>

    <div class="rounded-2xl border border-slate-800 bg-bg-800 p-6">
      <h2 class="text-lg font-semibold text-slate-200">Example use cases</h2>
      <div class="mt-3 space-y-3">
        <div class="rounded-lg border border-slate-700 bg-bg-900 p-3">
          <p class="text-sm font-semibold text-slate-200">Company VPN with internal DNS</p>
          <p class="mt-1 text-xs text-slate-400">
            Route <code class="bg-bg-900 px-1 rounded">corporate.local</code> to <code class="bg-bg-900 px-1 rounded">10.10.1.53</code> (internal AD DNS server)
          </p>
        </div>
        <div class="rounded-lg border border-slate-700 bg-bg-900 p-3">
          <p class="text-sm font-semibold text-slate-200">Local DNS stub for services</p>
          <p class="mt-1 text-xs text-slate-400">
            Route <code class="bg-bg-900 px-1 rounded">*.svc.local</code> to <code class="bg-bg-900 px-1 rounded">127.0.0.1:5353</code> (CoreDNS on localhost)
          </p>
        </div>
        <div class="rounded-lg border border-slate-700 bg-bg-900 p-3">
          <p class="text-sm font-semibold text-slate-200">Multi-site routing</p>
          <p class="mt-1 text-xs text-slate-400">
            Home DNS: <code class="bg-bg-900 px-1 rounded">local.home</code> ‚Üí Primary | Office DNS: <code class="bg-bg-900 px-1 rounded">local.office</code> ‚Üí Forward to office server
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-2xl border border-slate-800 bg-bg-800 p-6">
      <h2 class="text-lg font-semibold text-slate-200">Config file location</h2>
      <p class="mt-2 text-sm text-slate-300">
        Forward zones are written to <code class="bg-bg-900 px-1 rounded">/shared/forward-zones.conf</code> and included in the Recursor config.
      </p>
      <div class="mt-3 rounded-lg border border-amber-500/30 bg-amber-500/10 p-3">
        <p class="text-sm text-amber-200">
          ‚ö†Ô∏è Changes take effect after the next reload cycle (default ~5 seconds).
        </p>
      </div>
    </div>

    <a class="inline-flex items-center gap-2 text-sm text-indigo-400 hover:text-indigo-300" href="/forwardzones">‚Üí Go to Forward Zones</a>
  </div>
{% endblock %}
